# 邮箱配置说明

## 支持的邮箱服务

系统已自动适配以下邮箱服务：

### 1. QQ 邮箱 (@qq.com)

```env
EMAIL_USER=your_email@qq.com
EMAIL_PASS=你的授权码
```

**获取授权码步骤：**

1. 登录 QQ 邮箱网页版
2. 进入 **设置** → **账户**
3. 找到 **POP3/IMAP/SMTP/Exchange/CardDAV/CalDAV 服务**
4. 开启 **IMAP/SMTP 服务**
5. 点击 **生成授权码**
6. 使用授权码（不是登录密码）

---

### 2. 163 邮箱 (@163.com) ⭐ 当前配置

```env
EMAIL_USER=your_email@163.com
EMAIL_PASS=你的授权码
```

**获取授权码步骤：**

1. 登录 163 邮箱网页版
2. 进入 **设置** → **POP3/SMTP/IMAP**
3. 开启 **IMAP/SMTP 服务** 或 **客户端授权密码**
4. 设置/获取授权码
5. 使用授权码（不是登录密码）

**服务器配置：**

- SMTP 服务器：smtp.163.com
- 端口：465 (SSL)
- 安全连接：是

---

### 3. 126 邮箱 (@126.com)

```env
EMAIL_USER=your_email@126.com
EMAIL_PASS=你的授权码
```

**获取授权码步骤：**

1. 登录 126 邮箱网页版
2. 进入 **设置** → **POP3/SMTP/IMAP**
3. 开启服务并获取授权码

**服务器配置：**

- SMTP 服务器：smtp.126.com
- 端口：465 (SSL)

---

### 4. Gmail (@gmail.com)

```env
EMAIL_USER=your_email@gmail.com
EMAIL_PASS=应用专用密码
```

**获取应用专用密码步骤：**

1. 开启两步验证
2. 访问 https://myaccount.google.com/apppasswords
3. 生成应用专用密码

---

## 常见问题

### ❌ 问题 1：发送失败 - 535 Authentication failed

**原因：** 授权码错误或未使用授权码

**解决：**

- 确认使用的是授权码，不是登录密码
- 重新生成授权码
- 检查 `.env` 文件中的配置

---

### ❌ 问题 2：发送失败 - 连接超时

**原因：** 网络问题或端口被封

**解决：**

- 检查网络连接
- 尝试使用其他端口（25 或 587）
- 关闭防火墙测试

---

### ❌ 问题 3：发送失败 - SMTP 服务未开启

**原因：** 邮箱未开启 SMTP 服务

**解决：**

- 登录邮箱网页版
- 在设置中开启 POP3/SMTP/IMAP 服务
- 重新获取授权码

---

### ❌ 问题 4：163 邮箱提示"客户端授权码错误"

**原因：**

- 未开启客户端授权
- 授权码输入错误
- 授权码过期

**解决：**

1. 登录 163 邮箱
2. 设置 → POP3/SMTP/IMAP
3. 开启 **客户端授权密码** 功能
4. 设置或重新获取授权码
5. 注意：授权码通常是 **字母+数字** 的组合

---

## 开发模式（无需配置邮箱）

如果不配置邮箱，系统会在控制台显示验证码：

```env
# 留空即可
EMAIL_USER=
EMAIL_PASS=
```

启动后，注册时验证码会在控制台显示：

```
📧 验证码 [user@example.com]: 123456
```

---

## 测试邮件发送

修改配置后，建议测试：

1. 启动应用 `npm start`
2. 访问注册页面
3. 输入用户名和邮箱
4. 点击"发送验证码"
5. 查看控制台输出

**成功输出示例：**

```
✅ 验证码邮件已发送至: user@163.com
```

**失败输出示例：**

```
❌ 发送邮件失败: Error: Invalid login: 535 Authentication failed
📧 验证码 [user@163.com]: 123456
```

---

## 当前配置检查

您当前的配置：

```env
EMAIL_USER=gc2839474636@163.com
EMAIL_PASS=KBUnDM2FeFP7QX7a
```

**检查清单：**

- [x] 邮箱格式正确
- [ ] 已开启 SMTP 服务
- [ ] 授权码正确（不是登录密码）
- [ ] 授权码未过期

---

## 修改建议

如果发送失败，请按以下步骤操作：

### 步骤 1：确认 163 邮箱 SMTP 服务已开启

1. 登录 https://mail.163.com
2. 设置 → POP3/SMTP/IMAP
3. 确认服务已开启

### 步骤 2：重新获取授权码

1. 在同一页面找到"客户端授权密码"
2. 点击"设置/修改客户端授权密码"
3. 按提示操作（可能需要手机验证）
4. 获取新的授权码

### 步骤 3：更新 .env 文件

```env
EMAIL_USER=gc2839474636@163.com
EMAIL_PASS=新的授权码（通常是16位字母数字组合）
```

### 步骤 4：重启应用

```bash
# 停止当前应用（Ctrl+C）
# 重新启动
npm start
```

---

## 技术支持

如仍有问题，请提供：

1. 使用的邮箱类型
2. 控制台完整错误信息
3. 是否已开启 SMTP 服务
4. 是否使用授权码

---

**提示：** 大部分邮件发送问题都是因为使用了登录密码而不是授权码！
